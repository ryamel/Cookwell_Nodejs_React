{"ast":null,"code":"import _classCallCheck from\"/Users/ryan/Documents/cookwell-react-express/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/ryan/Documents/cookwell-react-express/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/ryan/Documents/cookwell-react-express/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/ryan/Documents/cookwell-react-express/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/ryan/Documents/cookwell-react-express/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import BrowseCard from'../components/browseCard';import'./recipes.sass';import Footer from'../components/footer';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";var source;// added task. Pagination using random recipes.\nvar Recipes=/*#__PURE__*/function(_Component){_inherits(Recipes,_Component);var _super=_createSuper(Recipes);function Recipes(props){var _this;_classCallCheck(this,Recipes);_this=_super.call(this,props);_this.state={cardData:[],isLoaded:false,loadFooter:false,atBottom:false,height:window.innerHeight,skip:0,limit:20};source=axios.CancelToken.source();_this.handleScroll=_this.handleScroll.bind(_assertThisInitialized(_this));_this.loadMoreRecipes=_this.loadMoreRecipes.bind(_assertThisInitialized(_this));return _this;}_createClass(Recipes,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;window.addEventListener(\"scroll\",this.handleScroll);axios.get(\"/api/recipes/page/0/\"+this.state.limit,{cancelToken:source.token}).then(function(res){_this2.setState(function(prevState){return{cardData:res.data,isLoaded:true,loadFooter:true,skip:prevState.skip+prevState.limit};});});}},{key:\"loadMoreRecipes\",value:function loadMoreRecipes(){var _this3=this;axios.get(\"/api/recipes/page/\"+this.state.skip+\"/\"+this.state.limit,{cancelToken:source.token}).then(function(res){_this3.setState(function(prevState){return{cardData:prevState.cardData.concat(res.data),skip:prevState.skip+prevState.limit};},console.log(_this3.state.cardData));});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(source)source.cancel();window.removeEventListener(\"scroll\",this.handleScroll);}},{key:\"handleScroll\",value:function handleScroll(){var windowHeight=\"innerHeight\"in window?window.innerHeight:document.documentElement.offsetHeight;var body=document.body;var html=document.documentElement;var docHeight=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);var windowBottom=windowHeight+window.pageYOffset;if(windowBottom>=docHeight){console.log('bottom');this.loadMoreRecipes();}}},{key:\"render\",value:function render(){var isLoaded=this.state.isLoaded;if(!isLoaded){return null;}else{var cardData=this.state.cardData;//console.log(cardData)\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"browse-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"recipe-grid-container\",children:cardData.map(function(card,index){return/*#__PURE__*/_jsx(BrowseCard,{img:card.img,description:card.description,author:card.authid.name,aId:card.authid._id,rtitle:card.title,index:index,edit:false},index);})})});}}}]);return Recipes;}(Component);export default Recipes;","map":{"version":3,"sources":["/Users/ryan/Documents/cookwell-react-express/client/src/pages/recipes.jsx"],"names":["React","Component","BrowseCard","Footer","axios","source","Recipes","props","state","cardData","isLoaded","loadFooter","atBottom","height","window","innerHeight","skip","limit","CancelToken","handleScroll","bind","loadMoreRecipes","addEventListener","get","cancelToken","token","then","res","setState","prevState","data","concat","console","log","cancel","removeEventListener","windowHeight","document","documentElement","offsetHeight","body","html","docHeight","Math","max","scrollHeight","clientHeight","windowBottom","pageYOffset","map","card","index","img","description","authid","name","_id","title"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport BrowseCard from '../components/browseCard';\nimport './recipes.sass';\nimport Footer from '../components/footer';\nimport axios from 'axios';\nlet source;\n// added task. Pagination using random recipes.\n\n\nclass Recipes extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tcardData: [],\n\t\t\tisLoaded: false,\n\t\t\tloadFooter: false,\n\t\t\tatBottom: false,\n\t\t\theight: window.innerHeight,\n\t\t\tskip: 0,\n\t\t\tlimit: 20\n\t\t}\n\t\tsource = axios.CancelToken.source();\n\t\tthis.handleScroll = this.handleScroll.bind(this);\n\t\tthis.loadMoreRecipes = this.loadMoreRecipes.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener(\"scroll\", this.handleScroll);\n\t\t\n\t\taxios.get(\"/api/recipes/page/0/\" + this.state.limit, {cancelToken: source.token})\n\t\t\t.then(res => {\n\t\t\t\t\tthis.setState(prevState => ({\n\t\t\t\t\t\tcardData: res.data,\n\t\t\t\t\t\tisLoaded: true,\n\t\t\t\t\t\tloadFooter: true,\n\t\t\t\t\t\tskip: prevState.skip + prevState.limit\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t)\n\t}\n\n\tloadMoreRecipes() { \n\t\taxios.get(\"/api/recipes/page/\" + this.state.skip + \"/\" + this.state.limit, {cancelToken: source.token})\n\t\t\t.then(res => {\n\t\t\t\t\tthis.setState(prevState => ({\n\t\t\t\t\t\tcardData: prevState.cardData.concat(res.data),\n\t\t\t\t\t\tskip: prevState.skip + prevState.limit\n\t\t\t\t\t}), console.log(this.state.cardData));\n\t\t\t\t}\n\t\t\t)\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif (source) source.cancel();\n\t    window.removeEventListener(\"scroll\", this.handleScroll);\n\t}\n\n\n\thandleScroll() {\n        const windowHeight = \"innerHeight\" in window ? window.innerHeight : document.documentElement.offsetHeight;\n        const body = document.body;\n        const html = document.documentElement;\n        const docHeight = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);\n        const windowBottom = windowHeight + window.pageYOffset;\n        if (windowBottom >= docHeight ) {\n            console.log('bottom');\n            this.loadMoreRecipes();\n        }\n    }\n\n\n\trender() {\n\t\tconst {isLoaded } = this.state;\n\n\t\tif (!isLoaded) {\n\t\t\treturn null;\n\t\t} else {\n\t\t\tconst { cardData } = this.state;\n\t\t\t//console.log(cardData)\n\t\t\treturn (\n\t\t\t\t<div className='browse-body'>\n\t\t\t\t\t<div className='recipe-grid-container' >\n\t\t\t\t\t\t{cardData.map((card, index) => \n\t\t\t\t\t\t\t<BrowseCard \n\t\t\t\t\t\t\t\tkey={index} \n\t\t\t\t\t\t\t\timg={card.img} \n\t\t\t\t\t\t\t\tdescription={card.description} \n\t\t\t\t\t\t\t\tauthor={card.authid.name} \n\t\t\t\t\t\t\t\taId={card.authid._id} \n\t\t\t\t\t\t\t\trtitle={card.title} \n\t\t\t\t\t\t\t\tindex={index} \n\t\t\t\t\t\t\t\tedit={false}\n\t\t\t\t\t\t\t\t/>\t\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t{/*<Footer isLoaded={this.state.loadFooter} />*/}\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t}\n}\n\n\n\n\n\n\nexport default Recipes;"]},"metadata":{},"sourceType":"module"}