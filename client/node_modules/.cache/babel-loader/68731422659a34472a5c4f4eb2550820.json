{"ast":null,"code":"import _slicedToArray from\"/Users/ryan/Documents/cookwell-react-express/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component,useState,useEffect}from\"react\";import BrowseCard from'../components/browseCard';import'./review-page.sass';import axios from'axios';import{Link,useHistory}from\"react-router-dom\";import ContactForm from'../components/contactForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ReviewPage=function ReviewPage(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),render=_useState4[0],setRender=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openMail=_useState6[0],setOpenMail=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),openMail_email=_useState8[0],setOpenMail_email=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),openMail_authName=_useState10[0],setOpenMail_authName=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),openMail_rtitle=_useState12[0],setOpenMail_rtitle=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),openMail_authid=_useState14[0],setOpenMail_authid=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),errMsg=_useState16[0],setErrMsg=_useState16[1];var history=useHistory();useEffect(function(){var source=axios.CancelToken.source();axios.get('/api/recipes/getreview',{cancelToken:source.token}).then(function(res){setData(res.data);}).catch(function(err){history.push('/');});return function(){return source.cancel();};},[render]);var approveRecipe=function approveRecipe(rtitle,authid){var body=JSON.stringify({title:rtitle,authid:authid});axios.post('/api/recipes/approve',body,{cancelToken:source.token}).then(function(res){setRender(render+1);}).catch(function(err){return console.log(err);});};var openEmail=function openEmail(email,authorName,rtitle,authid){setOpenMail(true);setOpenMail_email(email);setOpenMail_authName(authorName);setOpenMail_rtitle(rtitle);setOpenMail_authid(authid);};var handleError=function handleError(errMsg){if(errMsg.length>0){setErrMsg(errMsg);var timer=setTimeout(function(){setErrMsg('');},5500);}};if(!data){return null;}else{return/*#__PURE__*/_jsxs(React.Fragment,{children:[errMsg.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"bannerMsgBar\",children:errMsg}),/*#__PURE__*/_jsxs(\"div\",{id:\"review-container\",children:[/*#__PURE__*/_jsxs(\"table\",{id:\"rev-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{id:\"title-auth\",children:\"Author / User\"}),/*#__PURE__*/_jsx(\"th\",{id:\"title-recipe\",children:\"Recipe\"}),/*#__PURE__*/_jsx(\"th\",{id:\"title-date\",children:\"Uploaded (YY/DD/MM)\"}),/*#__PURE__*/_jsx(\"th\",{id:\"title-approve\",children:\"Approve Recipe\"}),/*#__PURE__*/_jsx(\"th\",{id:\"title-contact\",children:\"Contact Author\"}),/*#__PURE__*/_jsx(\"th\",{id:\"title-sentEmail\",children:\"Sent Email\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.length>0&&data.map(function(recipe,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[\" \",recipe.authid.name]}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",/*#__PURE__*/_jsx(Link,{to:{pathname:process.env.PUBLIC_URL+'/recipe-page/?rtitle='+recipe.title},children:recipe.title}),\" \"]}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",recipe.uploadDate.slice(0,10),\" \"]}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return approveRecipe(recipe.title,recipe.authid._id);},children:\"Approve\"}),\" \"]}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return openEmail(recipe.authid.email,recipe.authid.name,recipe.title,recipe.authid._id);},children:\"Send Email\"}),\" \"]}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",recipe.contactedAuthor?'Awaiting response':'No message sent',\" \"]})]},index);})})]}),data.length<1&&/*#__PURE__*/_jsx(\"div\",{id:\"noData\",children:\"No recipes for review\"})]}),openMail&&/*#__PURE__*/_jsx(ContactForm,{authName:openMail_authName,authorEmail:openMail_email,authid:openMail_authid,rtitle:openMail_rtitle,handleError:handleError,setOpenMail:setOpenMail})]});}};// need to close email window after send, and reset openMail to false\nexport default ReviewPage;","map":{"version":3,"sources":["/Users/ryan/Documents/cookwell-react-express/client/src/pages/review-page.jsx"],"names":["React","Component","useState","useEffect","BrowseCard","axios","Link","useHistory","ContactForm","ReviewPage","data","setData","render","setRender","openMail","setOpenMail","openMail_email","setOpenMail_email","openMail_authName","setOpenMail_authName","openMail_rtitle","setOpenMail_rtitle","openMail_authid","setOpenMail_authid","errMsg","setErrMsg","history","source","CancelToken","get","cancelToken","token","then","res","catch","err","push","cancel","approveRecipe","rtitle","authid","body","JSON","stringify","title","post","console","log","openEmail","email","authorName","handleError","length","timer","setTimeout","map","recipe","index","name","pathname","process","env","PUBLIC_URL","uploadDate","slice","_id","contactedAuthor"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from \"react\";\nimport BrowseCard from '../components/browseCard';\nimport './review-page.sass';\nimport axios from 'axios';\nimport { Link, useHistory } from \"react-router-dom\";\nimport ContactForm from '../components/contactForm';\n\n\n\nconst ReviewPage = () => {\n\tconst [data, setData] = useState(null);\n\tconst [render, setRender] = useState(1);\n\tconst [openMail, setOpenMail] = useState(false);\n\tconst [openMail_email, setOpenMail_email] = useState(false);\n\tconst [openMail_authName, setOpenMail_authName] = useState(false);\n\tconst [openMail_rtitle, setOpenMail_rtitle] = useState(false);\n\tconst [openMail_authid, setOpenMail_authid] = useState(false);\n\tconst [errMsg, setErrMsg] = useState('');\n\tlet history = useHistory();\n\n\tuseEffect(() => {\n\t\tlet source = axios.CancelToken.source();\n\n\t\taxios.get('/api/recipes/getreview', {cancelToken: source.token})\n\t\t\t.then(res => {\n\t\t\t\tsetData(res.data);\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\thistory.push('/');\n\t\t\t});\n\n\t\treturn () => source.cancel();\n\t}, [render])\n\n\n\tconst approveRecipe = (rtitle, authid) => {\n\t\tconst body = JSON.stringify({\n\t\t\ttitle: rtitle,\n\t\t\tauthid: authid\n\t\t})\n\n\t\taxios.post('/api/recipes/approve', body, {cancelToken: source.token} )\n\t\t\t.then(res => {\n\t\t\t\tsetRender(render + 1);\n\t\t\t})\n\t\t\t.catch(err => console.log(err));\n\t}\n\n\tconst openEmail = (email, authorName, rtitle, authid) => {\n\t\tsetOpenMail(true);\n\t\tsetOpenMail_email(email);\n\t\tsetOpenMail_authName(authorName);\n\t\tsetOpenMail_rtitle(rtitle);\n\t\tsetOpenMail_authid(authid);\n\t}\n\n\tconst handleError = (errMsg) => {\n\t\tif (errMsg.length > 0) {\n\t\t\tsetErrMsg(errMsg);\n\t\t\tconst timer = setTimeout(() => {\n\t\t\t\tsetErrMsg('');\n\t\t\t}, 5500);\n\t\t}\n\t}\n\n\tif (!data) {\n\t\treturn null;\n\t} else {\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t{\terrMsg.length > 0 && <div className='bannerMsgBar'>{errMsg}</div>\t}\n\t\t\t\t<div id=\"review-container\">\n\t\t\t\t\t<table id=\"rev-table\">\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th id=\"title-auth\">Author / User</th>\n\t\t\t\t\t\t\t\t<th id=\"title-recipe\">Recipe</th>\n\t\t\t\t\t\t\t\t<th id=\"title-date\">Uploaded (YY/DD/MM)</th>\n\t\t\t\t\t\t\t\t<th id=\"title-approve\">Approve Recipe</th>\n\t\t\t\t\t\t\t\t<th id=\"title-contact\">Contact Author</th>\n\t\t\t\t\t\t\t\t<th id=\"title-sentEmail\">Sent Email</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t{\tdata.length > 0 &&\n\t\t\t\t\t\t\t\tdata.map((recipe, index) => {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<tr key={index}>\n\t\t\t\t\t\t\t\t\t\t\t<td> {recipe.authid.name}</td>\n\t\t\t\t\t\t\t\t\t\t\t<td> <Link to={{pathname: process.env.PUBLIC_URL + '/recipe-page/?rtitle=' + recipe.title}}>{recipe.title}</Link> </td>\n\t\t\t\t\t\t\t\t\t\t\t<td> {recipe.uploadDate.slice(0, 10)} </td>\n\t\t\t\t\t\t\t\t\t\t\t<td> <button onClick={() => approveRecipe(recipe.title, recipe.authid._id) }>Approve</button> </td>\n\t\t\t\t\t\t\t\t\t\t\t<td> <button onClick={() => openEmail(recipe.authid.email, recipe.authid.name, recipe.title, recipe.authid._id) }>Send Email</button> </td>\n\t\t\t\t\t\t\t\t\t\t\t<td> {recipe.contactedAuthor ?  'Awaiting response' : 'No message sent'} </td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t  \t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t\t\t{\tdata.length < 1 && <div id='noData'>No recipes for review</div>\t\t}\t\t\n\t\t\t\t</div>\n\t\t\t\t\t{\topenMail && \n\t\t\t\t\t\t\t<ContactForm \n\t\t\t\t\t\t\t\tauthName={openMail_authName} \n\t\t\t\t\t\t\t\tauthorEmail={openMail_email} \n\t\t\t\t\t\t\t\tauthid={openMail_authid}\n\t\t\t\t\t\t\t\trtitle={openMail_rtitle}\n\t\t\t\t\t\t\t\thandleError={handleError}\n\t\t\t\t\t\t\t\tsetOpenMail={setOpenMail} \n\t\t\t\t\t\t\t\t/>\t\n\t\t\t\t\t}\n\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n}\n\n// need to close email window after send, and reset openMail to false\n\n\n\n\n\n\n\n\nexport default ReviewPage;\n\n\n"]},"metadata":{},"sourceType":"module"}